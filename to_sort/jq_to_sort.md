```
jq '[.[]|select(.uri | contains("/api/weather")| not) | select(.status_code == 200)|.uri]|unique' http.log

jq '[.[]|select(.uri | test("\\/api\\/weather\\?station_id=(\\d*,)*\\d+")) | select(.status_code == 200)|.uri]|unique' http.log

jq '.[1:3][]|{ip: .["id.orig_h"], data: {uri: .uri, host: .host, username: .username, user_agent: .user_agent}}' http.log

jq '.[1:3][]|{ip: .["id.orig_h"], fields: (.uri + .host + .username + .user_agent)} | select(.fields| contains(""))' http.log

jq '.[1:3][]|{ip: .["id.orig_h"], fields: (.uri + .host + .username + .user_agent)} | select(.fields| contains("'\''"))' http.log

jq '.[]|{ip: .["id.orig_h"], fields: (.uri + .host + .username + .user_agent)} | select(.fields| contains("'\''"))' http.log

jq '.[]|{ip: .["id.orig_h"], fields: (.uri + .host + .username + .user_agent)} | select(.fields| contains("'\''") or contains("passwd"))' http.log

jq '[.[]|{ip: .["id.orig_h"], fields: (.uri + .host + .username + .user_agent)} | select(.fields| contains("'\''") or contains("pass") or contains("<") or contains("{ :; }"))| .ip]|unique' http.log|wc -l

jq '.[]|(.uri + .host + .username + .user_agent) as $fields | map(select(.fields | contains("'\''") or contains("pass") or contains("<") or contains("{ :; }")))|.uri|unique'

jq '.[]|(.uri + .host + .username + .user_agent) as $fields | map(select(.fields | test("'\''|\\<|pass|\\{ \\:\\; \\}")))|.uri|unique'
```


List 75 IP address:
```
jq '[.[]|{ip: .["id.orig_h"], fields: (.uri + .host + .username + .user_agent)} | select(.fields| contains("'"'"'") or contains("pass") or contains("<") or contains(":; };"))| .ip]|unique|.[]' http.log
```

```
jq '[.[]|(.uri + .host + .username + .user_agent) as $fields | select(.fields| contains("'"'"'") or contains("pass") or contains("<") or contains(":; };"))| .ip]|unique|.[]' http.log

.[]|(.uri + .host + .username + .user_agent) as $fields
```



Using variables:
```
jq '[.[]|(.uri + .host + .username + .user_agent) as $fields | select($fields| contains("'"'"'") or contains("pass") or contains("<") or contains(":; };"))]|.[]["id.orig_h"]' http.log |wc -l


jq '[.[]|(.uri + .host + .username + .user_agent) as $fields | select($fields| test("pass|<|'\''|{ :; }"))]|.[]["id.orig_h"]' http.log |wc -l
75
```





```
root@kali:~/Downloads/kringlecon#
jq '(map((.uri+.host+.username+.user_agent) as $fields | select($fields | test("pass|<|'\''|{ :; }"))) | .[]["id.orig_h"]) as $ips | .[]|select(.["id.orig_h"]| in($ips[]))|. ' http.log | head -n 20


[.[]["id.orig_h"]]



jq '(map((.uri+.host+.username+.user_agent) as $fields | select($fields | test("pass|<|'\''|{ :; }"))) | .[]["id.orig_h"]) as $ips | .[]|select(.["id.orig_h"]| contains($ips))|.["id.orig_h"]' http.log | wc -l


Returns the 75
jq '(map((.uri+.host+.username+.user_agent) as $fields | select($fields | test("pass|<|'\''|{ :; }"))) | .[]["id.orig_h"]) as $ips | .[]|select(.["id.orig_h"]| contains($ips))|.["id.orig_h"]' http.log | wc -l


jq 'map((.uri+.host+.username+.user_agent) as $fields | select($fields | test("pass|<|'\''|{ :; }"))) | .[]["id.orig_h"]' http.log |head -n 30



jq 'map({uri: .uri}) | group_by(.uri) | map({uri: .[0].uri, Count: length}) | sort_by(.Count) | reverse | .[]' http.log | head -n 100





(map((.uri+.host+.username+.user_agent) as $fields | select($fields | test("pass|<|'\''|{ :; }"))) | .[].user_agent) as $agents
| map(select(.user_agent | contains($agents)))
|



jq '(map((.uri+.host+.username+.user_agent) as $fields | select($fields | test("pass|<|'\''|{ :; }"))) | .[].user_agent) as $agents | .[]|select(.user_agent | contains($agents)) | {ip: .["id.orig_h"], user_agent: .user_agent}' http.log

map({ItemId: .Properties.ItmId})

map({ItemId: .Properties.ItmId})             # extract the ItmID values
| group_by(.ItemId)                          # group by "ItemId"
| map({ItemId: .[0].ItemId, Count: length})  # store the counts
| .[]                                        # convert to a stream


jq '(map((.uri+.host+.username+.user_agent) as $fields | select($fields | test("pass|<|'\''|{ :; }"))) | .[].user_agent) as $agents | [.[].uri]' http.log | head -n 40




jq '[(map((.uri+.host+.username+.user_agent) as $fields | select($fields | test("pass|<|'\''|{ :; }"))) | .[].user_agent) as $agents | .[] | select(.user_agent | contains($agents))|.["id.orig_h"]]' http.log | wc -l
```
