https://github.com/BGrewell/HTBClient/blob/master/HTBClient/client.py
https://github.com/SherlockSec/docs/blob/master/docs/htb-api/htb-api.md
https://github.com/QHpix/HackTheBox-python-api
https://github.com/Gr3atWh173/htb-cli
https://github.com/zachhanson94/htbcli/blob/master/htbcli/__main__.py
https://github.com/zachhanson94/htbcli/blob/master/htbcli/__init__.py
https://github.com/zachhanson94/htbcli
https://github.com/kulinacs/htb/blob/master/htb/__init__.py



HTB API

https://www.hackthebox.eu/api

|EndPoint|Desc|Request Type|Needs api_token?|Post Params|
|-|-|-|-|-|
|/charts/users/scores/|X|GET|Yes||
|/machines/get/{machine_id}|X|GET|Yes||
|/machines/get/all/|X|GET|Yes||
|/machines/get/matrix/{machine_id}|X|GET|Yes||
|/machines/get/owns|X|POST|Yes||
|/machines/vpnping/{vpn_server}|X|POST|Yes|{'id':machine_id}|
|/stats/daily/owns/{n}|X|POST|No||
|/stats/global|X|POST|No||
|/stats/overview|X|GET|NO||
|/user/id|X|POST|Yes||
|/users/htb/connection/status/|X|POST|Yes||
|/users/htb/fortress/connection/status/|X|POST|Yes||
|/vpnserver/freeslots/|X|POST|Yes||
|/vpnserver/status/all/|X|GET|Yes||


#### /stats/global
```
s.post(f"{base_url}/stats/global").json()
```
```
{'success': '1',
 'data': {'sessions': 1413, 'vpn': 1362, 'machines': 142, 'latency': '0.555'}}
```

#### /stats/overview
```
s.get(f"{base_url}/stats/overview").json()
```
```
{"users":"236k","machines":142,"challenges":97}
```

#### /user/id
```python
s.post(f"{base_url}/user/id?api_token={api_token}", data={"username": "Glasgow"}).json()
```
```
{"username":"Glasgow","id":12700}
```

#### /stats/daily/owns/{n}
```python
s.post(f"{base_url}/stats/daily/owns/5").json()
```
```
{'success': '1',
 'userowns': [418166, 418987, 419813, 420663, 421643],
 'rootowns': [364733, 365505, 366322, 367088, 368026],
 'users': [236055, 236451, 236869, 237233, 237668]}
```


/vpnserver/freeslots/
post
authenticated

/vpnserver/status/all/
get
authenticated




charts/users/scores
get
auth


```
s.post(f"{base_url}/users/htb/connection/status/?api_token={api_token}").json()
```
```
{'success': '1',
 'connection': {'name': 'Glasgow',
  'ip4': '10.10.14.X',
  'ip6': 'dead:beef:2::X',
  'down': '1.81',
  'up': '1.57'},
 'server': {'serverHostname': 'XXXXX',
  'serverPort': PORT}}
```

/users/htb/fortress/connection/status/
post
auth


/machines/get/all/
get
auth


/machines/get/owns
post
auth


/machines/get/{machine_id}
get
auth


/machines/vpnping/{vpn_server}
post
data={'id':machine_id}
auth



```python
from tabulate import tabulate

x = s.get(f"{base_url}/machines/get/all/?api_token={api_token}").json()

# add headers
x.insert(0, {field: field for field in x[0]})

# remove some columns
for element in x:
    element.pop("avatar_thumb", None)
    element.pop("maker", None)
    element.pop("free", None)
    element.pop("maker2", None)

# print output
print(tabulate(x, tablefmt="fancy_grid"))
```

```
import requests
import configparser
from pathlib import Path
from tabulate import tabulate

config = configparser.ConfigParser()
config.read(Path().home() / "config")
# api_token = "api_token_from_htb_profile"
api_token = config["htb_api"]["api_token"]

s = requests.session()
s.headers = {'user-agent': 'api'}
base_url = "https://www.hackthebox.eu/api"

x = s.get(f"{base_url}/machines/get/all/?api_token={api_token}").json()

for element in x:
    for i in ["avatar_thumb", "maker", "free", "maker2"]:
        element.pop(i, None)

print(tabulate(x, tablefmt="fancy_grid", headers={field: field for field in x[0]}))
```




```python
import requests

class HTB():
    def __init__(self, api_token):
        self.session = requests.session()
        self.session.headers = {'user-agent': 'htb_api'}
        self.api_url = "https://www.hackthebox.eu/api"
        self.api_token = api_token

    def _call_api(self, endpoint, request_type="GET", auth=True, params={}):
        # padding endpoint with "/" (multiple, consecutive "/" do not impact/affect the url)
        url = f"{self.api_url}{endpoint}"

        if auth:
            url += f"?api_token={self.api_token}"

        if request_type == "GET":
            return self.session.get(url).json()
        else:
            return self.session.post(url, params).json()

    def list_machines(self):
        machines = self._call_api(endpoint = "/machines/get/all/", request_type = "GET", auth=True)
        #machines = self.session.get(f"{self.api_url}/machines/get/all/?api_token={self.api_token}").json()
        return machines

```
