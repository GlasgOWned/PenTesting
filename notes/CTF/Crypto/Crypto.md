# Crypto

### Resources:

### Tools:
* [ciphey](https://github.com/ciphey/ciphey)
  * `docker run -it --rm remnux/ciphey`

### References:


List of various ciphers (including some solvers) - http://rumkin.com/tools/cipher/


#### Fernet
https://cryptography.io/en/latest/fernet/



https://www.rootnetsec.com/picoctf-weird-rsa/
https://en.wikipedia.org/wiki/RSA_(cryptosystem)
https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Using_the_Chinese_remainder_algorithm


### Snippets:
```python
import binascii

print(binascii.unhexlify('7061756c'))
# paul

print(binascii.hexlify('Justin'))
# '4a757374696e'

```

```
alias rot13="tr 'A-Za-z' 'N-ZA-Mn-za-m'"
```

Python3 rot_n (rot13 or other values)
`for python2, use string.maketrans`
```python
from string import ascii_uppercase as uc, ascii_lowercase as lc

def rot_n(strInput, n=13):
    n = n % 26
    rot = str.maketrans(uc + lc, uc[n:] + uc[:n] + lc[n:] + lc[:n])
    return str.translate(strInput, rot)
```


base64/base32 "intelligent" decode
```python
from base64 import b64decode, b32decode

def unbase(thestring):
    if len(set(thestring.decode('utf-8'))) > 32:
        return b64decode(thestring)
    else:
        return b32decode(thestring)
```

Convert from message to decimal:
```
message: HELLO
ascii bytes: [72, 69, 76, 76, 79]
hex bytes: [0x48, 0x45, 0x4c, 0x4c, 0x4f]
base-16: 0x48454c4c4f
base-10: 310400273487
```

Using pycryptodome (`pip install pycryptodome`)
```
from Crypto.Util.number import bytes_to_long, long_to_bytes
```

```python
from pwn import *
from Crypto.Util.number import *
import json, codecs

d = {
        "base64": b64d,
        "hex": unhex,
        "rot13": lambda s: codecs.encode(s, 'rot_13').encode(),
        "bigint": lambda s: long_to_bytes(int(s, 0)),
        "utf-8": bytes
}

def dec(o):
    return d[o["type"]](o["encoded"])

io = remote("socket.cryptohack.org", 13377)
for _ in range(100):
    o = json.loads(io.recvline())
    io.sendline(json.dumps({"decoded": dec(o).decode()}))
io.interactive()
```


xor all characters of a string with a given integer
```python
x = "some_string".encode()
bytes(map(lambda x: x^13, x.encode()))

import pwn

pwn.xor(b'label', 13)
```


from pwn import unhex


Cracking hashes
https://md5hashing.net
https://crackstation.net/



https://en.wikipedia.org/wiki/Malbolge
https://www.tutorialspoint.com/execute_malbolge_online.php



Elliptic Curve Cryptography:
* https://hackernoon.com/what-is-the-math-behind-elliptic-curve-cryptography-f61b25253da3
* [A Coderâ€™s Guide to Elliptic Curve Cryptography](https://www.colby.edu/math/program/honorsprojects/2014-Morse-Honors.pdf)
* [basics of elliptic curve cryptography - gist](https://gist.github.com/bellbind/1414867/03b4b2dd79b41e65e51716076e5e2b0171628a10)
* https://math.stackexchange.com/questions/1259490/weierstrass-equation-long-vs-normal-form
* https://crypto.stanford.edu/pbc/notes/elliptic/weier.html
* https://crypto.stackexchange.com/questions/41407/why-must-an-elliptic-curve-group-for-ecc-have-prime-order
* https://en.wikipedia.org/wiki/Pollard%27s_kangaroo_algorithm
* https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm
* https://aadityapurani.com/2019/03/11/utctf-2019-writeups/
