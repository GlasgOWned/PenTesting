#/bin/bash

function check_type_and_uncompress()
{
    if [[ $(file --mime-type -b "$1") == application/zip ]]; then
        #unzip_file $1
        mv $1 $1.zip
        unzip -qq $1.zip
        rm $1.zip
    elif [[ $(file --mime-type -b "$1") == "application/x-xz" ]]; then
        #unxz_file $1
        mv $1 $1.xz
        unxz $1.xz
    elif [[ $(file --mime-type -b "$1") == "application/x-bzip2" ]]; then
        mv $1 $1.bz2
        bzip2 -d $1.bz2
    elif [[ $(file --mime-type -b "$1") == "application/gzip" ]]; then
        mv $1 $1.gz
        gunzip $1.gz
    else
        echo $(file --mime-type -b "$1")
    fi
}

unzip -qq security.ZIP
first_zip=$(ls |grep -v "ZIP"|grep -v "\.sh")

while true;
do
#my_file=$(ls |grep -v "ZIP"|grep -v "\.sh")
check_type_and_uncompress $(ls |grep -v "ZIP"|grep -v "\.sh")
done

rm $first_zip
